(()=>{function e(e,o){Office.context.mailbox.item.notificationMessages&&Office.context.mailbox.item.notificationMessages.addAsync("copyLinkNotification",{type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:o,icon:"Icon.16x16",persistent:!1})}Office.onReady(()=>{}),Office.actions.associate("copyEmailLink",function(o){const t=setTimeout(()=>{console.error("Function timeout - forcing completion"),o.completed()},1e4);try{Office.context.mailbox.item.getItemIdAsync(i=>{try{if(i.status===Office.AsyncResultStatus.Failed)return clearTimeout(t),console.error("Error getting item ID:",i.error),e(0,"Failed to get email ID"),void o.completed();const c=i.value,n=`https://outlook.office.com/mail/id/${Office.context.mailbox.convertToRestId(c,Office.MailboxEnums.RestVersion.v2_0)}`;console.log("Generated email link:",n),async function(e){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e),console.log("Copied using navigator.clipboard"),!0}catch(e){console.log("navigator.clipboard failed:",e)}try{const o=document.createElement("textarea");o.value=e,o.style.position="fixed",o.style.left="-999999px",o.style.top="-999999px",document.body.appendChild(o),o.focus(),o.select();const t=document.execCommand("copy");if(document.body.removeChild(o),t)return console.log("Copied using execCommand"),!0}catch(e){console.error("execCommand failed:",e)}return console.error("All clipboard methods failed"),!1}(n).then(i=>{clearTimeout(t),console.log("Clipboard operation result:",i),e(0,i?"Link copied! Paste it anywhere.":n.substring(0,100)),o.completed()}).catch(i=>{clearTimeout(t),console.error("Clipboard error:",i),e(0,n.substring(0,100)),o.completed()})}catch(i){clearTimeout(t),console.error("Error in getItemIdAsync callback:",i),e(0,"An error occurred: "+i.message),o.completed()}})}catch(i){clearTimeout(t),console.error("Error in copyEmailLink:",i),e(0,"Failed to copy link"),o.completed()}})})();